<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 2 Vector data operations | Spatial R Exercise 4: Geometric Operations</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 2 Vector data operations | Spatial R Exercise 4: Geometric Operations" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 2 Vector data operations | Spatial R Exercise 4: Geometric Operations" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Ben Davies" />


<meta name="date" content="2022-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="raster-data-operations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Geometric operations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#adding-packages"><i class="fa fa-check"></i><b>1.1</b> Adding packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vector-data-operations.html"><a href="vector-data-operations.html"><i class="fa fa-check"></i><b>2</b> Vector data operations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vector-data-operations.html"><a href="vector-data-operations.html#adding-data"><i class="fa fa-check"></i><b>2.1</b> Adding data</a></li>
<li class="chapter" data-level="2.2" data-path="vector-data-operations.html"><a href="vector-data-operations.html#finding-potential-threats-across-space"><i class="fa fa-check"></i><b>2.2</b> Finding potential threats across space</a></li>
<li class="chapter" data-level="2.3" data-path="vector-data-operations.html"><a href="vector-data-operations.html#try-it-yourself"><i class="fa fa-check"></i><b>2.3</b> Try it yourself</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="raster-data-operations.html"><a href="raster-data-operations.html"><i class="fa fa-check"></i><b>3</b> Raster Data Operations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="raster-data-operations.html"><a href="raster-data-operations.html#adding-vector-data"><i class="fa fa-check"></i><b>3.1</b> Adding vector data</a></li>
<li class="chapter" data-level="3.2" data-path="raster-data-operations.html"><a href="raster-data-operations.html#distance-function"><i class="fa fa-check"></i><b>3.2</b> <code>distance</code> function</a></li>
<li class="chapter" data-level="3.3" data-path="raster-data-operations.html"><a href="raster-data-operations.html#exploring-relationships-between-distance-and-another-feature"><i class="fa fa-check"></i><b>3.3</b> Exploring relationships between distance and another feature</a></li>
<li class="chapter" data-level="3.4" data-path="raster-data-operations.html"><a href="raster-data-operations.html#visualizing-and-quantifying-distance-relationships"><i class="fa fa-check"></i><b>3.4</b> Visualizing and quantifying distance relationships</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bringing-it-all-together.html"><a href="bringing-it-all-together.html"><i class="fa fa-check"></i><b>4</b> Bringing it all together!</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial R Exercise 4: Geometric Operations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vector-data-operations" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Part 2</span> Vector data operations<a href="vector-data-operations.html#vector-data-operations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Let’s imagine a scenario: Martha’s Vineyard and Nantucket Islands are home to several endemic species of special concern. You’ve been contracted by the New England Entomological Association to help them identify potential threats for the chain dotted geometer (Cingilia catenaria), a species of moth, in its preferred habitats (Open Land and Brushland/Successional). In addition to habitat loss due to human encroachment, threats include vehicle strikes and pesticides used in agriculture. The NEEA would like to know where the habitats are, and where they are being threatened.</p>
<div id="adding-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Adding data<a href="vector-data-operations.html#adding-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First things first, lets load the data we need to conduct this analysis. There are three files, each starting with the word “island”. Import these as vector datasets.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="vector-data-operations.html#cb7-1" aria-hidden="true" tabindex="-1"></a>coasts<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;island_outline.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `island_outline&#39; from data source 
##   `C:\Users\bdav_\Dropbox\Teaching\Spatial R Short Course\Bookdown\Exercise4\island_outline.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 18 features and 3 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 255304.2 ymin: 777606.4 xmax: 329063.4 ymax: 804036.7
## Projected CRS: NAD83 / Massachusetts Mainland</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="vector-data-operations.html#cb9-1" aria-hidden="true" tabindex="-1"></a>landuse<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;island_landuse.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `island_landuse&#39; from data source 
##   `C:\Users\bdav_\Dropbox\Teaching\Spatial R Short Course\Bookdown\Exercise4\island_landuse.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 12269 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 255304.2 ymin: 777606.4 xmax: 329063.4 ymax: 804036.7
## Projected CRS: NAD83 / Massachusetts Mainland</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="vector-data-operations.html#cb11-1" aria-hidden="true" tabindex="-1"></a>roads<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;island_roads.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `island_roads&#39; from data source 
##   `C:\Users\bdav_\Dropbox\Teaching\Spatial R Short Course\Bookdown\Exercise4\island_roads.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 6809 features and 71 fields
## Geometry type: MULTILINESTRING
## Dimension:     XY
## Bounding box:  xmin: 255536.6 ymin: 777674.6 xmax: 328894.4 ymax: 803946.2
## Projected CRS: NAD83 / Massachusetts Mainland</code></pre>
<p>##Getting the moth’s preferred habitats</p>
<p>Next, we want to look at this data and see what sorts of things are stored in it.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="vector-data-operations.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(landuse)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 310603.8 ymin: 781243.4 xmax: 312451.5 ymax: 783489.9
## Projected CRS: NAD83 / Massachusetts Mainland
##   OBJECTID                    LU05_DESC LUCODE       AREA       LEN Shape_Leng
## 1        1                    Open Land      6  9552.6483  742.6913   742.6913
## 2        2       Brushland/Successional     40 38475.3051 1454.3708  1454.3708
## 3        3       Brushland/Successional     40  1413.9615  150.0112   150.0112
## 4        4         Non-Forested Wetland      4  6961.6412  375.3539   375.3539
## 5        5         Non-Forested Wetland      4   623.2688  161.6040   161.6040
## 6        6 Very Low Density Residential     38  4578.2132  295.8042   295.8042
##   Shape_Area                       geometry
## 1  9552.6483 POLYGON ((310790.1 782366.3...
## 2 38475.3051 POLYGON ((310891.4 783361.4...
## 3  1413.9615 POLYGON ((311090 782745.9, ...
## 4  6961.6412 POLYGON ((311812.4 781292.2...
## 5   623.2688 POLYGON ((312088.9 782272.3...
## 6  4578.2132 POLYGON ((312447.6 783113.7...</code></pre>
<p>There’s a few different attributes here, but the one that’s most likely to help us figure out habitats and threats is the <em>LU05_DESC</em>, which is a description of landuse on a parcel of land as observed in 2005. Let’s look at what the unique values are for this attribute:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="vector-data-operations.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(landuse<span class="sc">$</span>LU05_DESC)</span></code></pre></div>
<pre><code>##  [1] &quot;Open Land&quot;                    &quot;Brushland/Successional&quot;      
##  [3] &quot;Non-Forested Wetland&quot;         &quot;Very Low Density Residential&quot;
##  [5] &quot;Low Density Residential&quot;      &quot;Water-Based Recreation&quot;      
##  [7] &quot;Water&quot;                        &quot;Multi-Family Residential&quot;    
##  [9] &quot;Nursery&quot;                      &quot;Forest&quot;                      
## [11] &quot;Medium Density Residential&quot;   &quot;Forested Wetland&quot;            
## [13] &quot;Commercial&quot;                   &quot;Mining&quot;                      
## [15] &quot;High Density Residential&quot;     &quot;Urban Public/Institutional&quot;  
## [17] &quot;Industrial&quot;                   &quot;Saltwater Sandy Beach&quot;       
## [19] &quot;Saltwater Wetland&quot;            &quot;Transportation&quot;              
## [21] &quot;Transitional&quot;                 &quot;Pasture&quot;                     
## [23] &quot;Participation Recreation&quot;     &quot;Cranberry Bog&quot;               
## [25] &quot;Orchard&quot;                      &quot;Cropland&quot;                    
## [27] &quot;Golf Course&quot;                  &quot;Cemetery&quot;                    
## [29] &quot;Marina&quot;                       &quot;Junkyard&quot;                    
## [31] &quot;Waste Disposal&quot;               &quot;Powerline/Utility&quot;           
## [33] &quot;Spectator Recreation&quot;</code></pre>
<p>From the description, we know that the moth’s preferred habitats are in Open Land and Brushland/Successional types of places. We can isolate these by using subset, but since there’s two of them, we can put both inside a vector with <code>c()</code> and then use the <code>%in</code> operator:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="vector-data-operations.html#cb17-1" aria-hidden="true" tabindex="-1"></a>preferredHabitats<span class="ot">&lt;-</span><span class="fu">subset</span>(landuse,LU05_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Open Land&quot;</span>,  <span class="st">&quot;Brushland/Successional&quot;</span>))</span>
<span id="cb17-2"><a href="vector-data-operations.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(preferredHabitats)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 310603.8 ymin: 781961.4 xmax: 312696.2 ymax: 783489.9
## Projected CRS: NAD83 / Massachusetts Mainland
##    OBJECTID              LU05_DESC LUCODE      AREA       LEN Shape_Leng
## 1         1              Open Land      6  9552.648  742.6913   742.6913
## 2         2 Brushland/Successional     40 38475.305 1454.3708  1454.3708
## 3         3 Brushland/Successional     40  1413.962  150.0112   150.0112
## 8         8              Open Land      6 19192.743  777.5628   777.5628
## 9         9              Open Land      6  5770.652  409.3352   409.3352
## 11       11              Open Land      6  1872.546  244.6481   244.6481
##    Shape_Area                       geometry
## 1    9552.648 POLYGON ((310790.1 782366.3...
## 2   38475.305 POLYGON ((310891.4 783361.4...
## 3    1413.962 POLYGON ((311090 782745.9, ...
## 8   19192.743 POLYGON ((312527.4 783295.4...
## 9    5770.652 POLYGON ((312548.9 783062.9...
## 11   1872.546 POLYGON ((312668.9 781966.9...</code></pre>
<p>Let’s map these out so we can see what we’re looking at.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="vector-data-operations.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(coasts))</span>
<span id="cb19-2"><a href="vector-data-operations.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(preferredHabitats),<span class="at">col=</span><span class="st">&quot;dark green&quot;</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="finding-potential-threats-across-space" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Finding potential threats across space<a href="vector-data-operations.html#finding-potential-threats-across-space" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>OK, now we know where the moth likes to live, so now we just need to figure out what might harm it in those spaces. The NEEA says that agricultural practices taking place within 500 m of a preferred habitat can be potentially harmful due to pesticide use. So let’s get all of the land where agriculture is practiced first. Have a look at the list of uniqe types we made above and see what you can find.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="vector-data-operations.html#cb20-1" aria-hidden="true" tabindex="-1"></a>agLand<span class="ot">&lt;-</span><span class="fu">subset</span>(landuse,LU05_DESC <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Orchards&quot;</span>,<span class="st">&quot;Cropland&quot;</span>,<span class="st">&quot;Nursery&quot;</span>,<span class="st">&quot;Pasture&quot;</span>))</span>
<span id="cb20-2"><a href="vector-data-operations.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(agLand)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 315489.3 ymin: 779397.1 xmax: 325471.3 ymax: 785622.1
## Projected CRS: NAD83 / Massachusetts Mainland
##     OBJECTID LU05_DESC LUCODE      AREA      LEN Shape_Leng Shape_Area
## 44        44   Nursery     36 14618.085 501.3215   501.3215  14618.085
## 195      195   Nursery     36  5500.052 341.7689   341.7689   5500.052
## 316      316   Pasture      2 13947.822 561.6673   561.6673  13947.822
## 525      525   Pasture      2  5506.502 333.6362   333.6362   5506.502
## 633      633   Pasture      2 20194.599 950.6085   950.6085  20194.599
## 680      680   Pasture      2  3839.795 288.5467   288.5467   3839.795
##                           geometry
## 44  POLYGON ((315642.4 780119.4...
## 195 POLYGON ((319304.7 780369, ...
## 316 POLYGON ((324900.6 779597.9...
## 525 POLYGON ((325469.7 785122.3...
## 633 POLYGON ((316148.8 782462.1...
## 680 POLYGON ((325463.1 785607.7...</code></pre>
<p>I’ve decided to leave out the Vineyard’s boutique cranberry bogs for now to keep things simple, but you can select any you think might be threatening. Lets see what this looks like with our preferred habitats.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="vector-data-operations.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(coasts))</span>
<span id="cb22-2"><a href="vector-data-operations.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(preferredHabitats),<span class="at">col=</span><span class="st">&quot;dark green&quot;</span>,<span class="at">add=</span>T)</span>
<span id="cb22-3"><a href="vector-data-operations.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(agLand),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>With all that we’re plotting, this graphic is getting hard to read. One way to alleviate that is to eliminate the borders from some of our polygon data:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="vector-data-operations.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(coasts))</span>
<span id="cb23-2"><a href="vector-data-operations.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(preferredHabitats),<span class="at">col=</span><span class="st">&quot;dark green&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span>
<span id="cb23-3"><a href="vector-data-operations.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(agLand),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Much better. Hmmm… looks like there may be some adjacency that is within 500m. Only one way to be sure, though.</p>
<p>##Buffer</p>
<p>The tool we want to figure out areas within a given distance from our agricultural areas is the <code>st_buffer</code> tool. This is not dissimilar to a buffer tool that is common in desktop GIS. First, we’ll want to know what linear units our agricultural land vector data is using. We can get that using <code>st_crs</code> and accessing the units from the coordinate system.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="vector-data-operations.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(agLand)<span class="sc">$</span>units</span></code></pre></div>
<pre><code>## [1] &quot;m&quot;</code></pre>
<p>Cool, we’re in meters, which is what we want to do. If it were something else, we might want to change coordinate systems, or convert our 500 m value into whatever units we’re using. Now we’re good to go with <code>st_buffer</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="vector-data-operations.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make agricultural buffer and plot</span></span>
<span id="cb26-2"><a href="vector-data-operations.html#cb26-2" aria-hidden="true" tabindex="-1"></a>agBuffer<span class="ot">&lt;-</span><span class="fu">st_buffer</span>(agLand,<span class="dv">500</span>)</span>
<span id="cb26-3"><a href="vector-data-operations.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(agBuffer),<span class="at">col=</span><span class="st">&quot;dark blue&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>)</span>
<span id="cb26-4"><a href="vector-data-operations.html#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(agLand),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>This is an excellent example of the kind of tedious grunt work that we leave the computer to do. If we were to do this by hand, depending on how precise we wanted to be, this could take quite some time to figure out where 500 m away from the edge of an agricultural parcel is. Thankfully, we don’t have to, and we can get on with asking spatial questions.</p>
<p>Now we have our agricultural land, and the buffers indicating spaces that might threaten our moth species. We need to do the same for roads, although here the threat is more localized. The NEEA says a 50 m margin should work fine for roads.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="vector-data-operations.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make road buffer and plot</span></span>
<span id="cb27-2"><a href="vector-data-operations.html#cb27-2" aria-hidden="true" tabindex="-1"></a>roadBuffer<span class="ot">&lt;-</span><span class="fu">st_buffer</span>(roads,<span class="dv">50</span>)</span>
<span id="cb27-3"><a href="vector-data-operations.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(roadBuffer),<span class="at">col=</span><span class="st">&quot;dark blue&quot;</span>)</span>
<span id="cb27-4"><a href="vector-data-operations.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(roads),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>##Intersection</p>
<p>As a last step, we want to see where our preferredHabitats overlap with our various threat buffers. For this operation, we can use the <code>st_intersection</code> function.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="vector-data-operations.html#cb28-1" aria-hidden="true" tabindex="-1"></a>agThreat<span class="ot">&lt;-</span><span class="fu">st_intersection</span>(preferredHabitats,agBuffer)</span></code></pre></div>
<pre><code>## Warning: attribute variables are assumed to be spatially constant throughout all
## geometries</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="vector-data-operations.html#cb30-1" aria-hidden="true" tabindex="-1"></a>roadThreat<span class="ot">&lt;-</span><span class="fu">st_intersection</span>(preferredHabitats,roadBuffer)</span></code></pre></div>
<pre><code>## Warning: attribute variables are assumed to be spatially constant throughout all
## geometries</code></pre>
<p>We’ve seen this warning before, and there isn’t anything really in our data that is affected (at least not any that we are going to use). Now we should be able to show where on the islands our moths might be affected and where they’ll be OK. Let’s make a nice plot (with axes!) we can give to the NEEA to bring to town meetings:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="vector-data-operations.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(coasts),<span class="at">axes=</span>T)</span>
<span id="cb32-2"><a href="vector-data-operations.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(preferredHabitats),<span class="at">col=</span><span class="st">&quot;dark green&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span>
<span id="cb32-3"><a href="vector-data-operations.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(agThreat),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span>
<span id="cb32-4"><a href="vector-data-operations.html#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(roadThreat),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">border=</span><span class="cn">NA</span>,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="try-it-yourself" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Try it yourself<a href="vector-data-operations.html#try-it-yourself" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See if you can do the following with this dataset:</p>
<ul>
<li>The local residents are likely to be a little peeved about any new restrictions on the roadsides. How does this look if you decrease the road buffer from 50 to 10 meters? Or maybe they’ll be very much on board and want it to be 100 meters! Try out some values.</li>
<li>Mines are not particularly good for this moth species either. What happens if you add mines to the list of hazards?</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="raster-data-operations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-VectorDataOperations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
