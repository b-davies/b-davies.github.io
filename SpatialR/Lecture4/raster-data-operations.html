<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 3 Raster Data Operations | Spatial R Exercise 4: Geometric Operations</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 3 Raster Data Operations | Spatial R Exercise 4: Geometric Operations" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 3 Raster Data Operations | Spatial R Exercise 4: Geometric Operations" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Ben Davies" />


<meta name="date" content="2022-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vector-data-operations.html"/>
<link rel="next" href="bringing-it-all-together.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Geometric operations</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#adding-packages"><i class="fa fa-check"></i><b>1.1</b> Adding packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vector-data-operations.html"><a href="vector-data-operations.html"><i class="fa fa-check"></i><b>2</b> Vector data operations</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vector-data-operations.html"><a href="vector-data-operations.html#adding-data"><i class="fa fa-check"></i><b>2.1</b> Adding data</a></li>
<li class="chapter" data-level="2.2" data-path="vector-data-operations.html"><a href="vector-data-operations.html#finding-potential-threats-across-space"><i class="fa fa-check"></i><b>2.2</b> Finding potential threats across space</a></li>
<li class="chapter" data-level="2.3" data-path="vector-data-operations.html"><a href="vector-data-operations.html#try-it-yourself"><i class="fa fa-check"></i><b>2.3</b> Try it yourself</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="raster-data-operations.html"><a href="raster-data-operations.html"><i class="fa fa-check"></i><b>3</b> Raster Data Operations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="raster-data-operations.html"><a href="raster-data-operations.html#adding-vector-data"><i class="fa fa-check"></i><b>3.1</b> Adding vector data</a></li>
<li class="chapter" data-level="3.2" data-path="raster-data-operations.html"><a href="raster-data-operations.html#distance-function"><i class="fa fa-check"></i><b>3.2</b> <code>distance</code> function</a></li>
<li class="chapter" data-level="3.3" data-path="raster-data-operations.html"><a href="raster-data-operations.html#exploring-relationships-between-distance-and-another-feature"><i class="fa fa-check"></i><b>3.3</b> Exploring relationships between distance and another feature</a></li>
<li class="chapter" data-level="3.4" data-path="raster-data-operations.html"><a href="raster-data-operations.html#visualizing-and-quantifying-distance-relationships"><i class="fa fa-check"></i><b>3.4</b> Visualizing and quantifying distance relationships</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bringing-it-all-together.html"><a href="bringing-it-all-together.html"><i class="fa fa-check"></i><b>4</b> Bringing it all together!</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial R Exercise 4: Geometric Operations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="raster-data-operations" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Part 3</span> Raster Data Operations<a href="raster-data-operations.html#raster-data-operations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Next, we’ll look at doing some distance-based operations using a raster dataset. This particular example deals with grocery stores and light rail stations in Denver, which has implications for food and transportation equity, but this method could easily be applied to any situation where we want to know how close or distant some entities (e.g., sites with evidence for butchery) are from other entities of interest (e.g., raw stone material sources).</p>
<div id="adding-vector-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Adding vector data<a href="raster-data-operations.html#adding-vector-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s get our train stations loaded.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="raster-data-operations.html#cb33-1" aria-hidden="true" tabindex="-1"></a>denverRail<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;denverRail.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `denverRail&#39; from data source 
##   `C:\Users\bdav_\Dropbox\Teaching\Spatial R Short Course\Bookdown\Exercise4\denverRail.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 77 features and 29 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -105.2013 ymin: 39.52047 xmax: -104.6739 ymax: 39.9229
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="raster-data-operations.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(denverRail),<span class="at">axes=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" />
Doesn’t look like much at the moment, but this is genuine, bonafide rail station data from the <a href="https://gis-rtd-denver.opendata.arcgis.com/">Denver RTD</a>. What we’re interested in is: how far are metro Denver’s grocery stores from a rail station?</p>
<p>##Adding some raster data</p>
<p>We’re going to use <code>terra</code>’s <code>distance</code> function to figure out how far away our train stations are from… well, to start we’re going to figure out how far away they are from everything. What we need to start is a raster dataset that more or less covers the same area. Here’s an elevation model once again from our friends at <a href="https://www.gebco.net/">GEBCO</a>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="raster-data-operations.html#cb36-1" aria-hidden="true" tabindex="-1"></a>denverDEM<span class="ot">&lt;-</span><span class="fu">rast</span>(<span class="st">&quot;denverDEM.asc&quot;</span>)</span></code></pre></div>
<p>You may have noticed that there’s a different file extension here from the usual <code>.tif</code>. This <code>.asc</code> file is an ASCII raster, which is also a common way to share raster data. Rather than being an image file like a GeoTIFF, the ASCII raster is a text table with the same number of rows and columns as the raster. At the very top of this file are 6 lines of text called a <em>header</em>, which gives whatever machine is reading it information about the number of rows, columns, etc. In order to be useful here, the ASCII file has to be accompanied by a <code>.prj</code> file, which you’ll see sitting in the working directory in the <em>Files</em> tab.</p>
<p>OK, so we need to make sure that these datasets are overlapping in terms of space. Let’s plot them and take a look:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="raster-data-operations.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(denverDEM,<span class="at">axes=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-2"><a href="raster-data-operations.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(denverRail),<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>OK, that looks pretty good so far. Let’s take a look at the <code>distance</code> function.</p>
</div>
<div id="distance-function" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> <code>distance</code> function<a href="raster-data-operations.html#distance-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>distance</code> function takes a raster and vector as arguments and returns a raster that gives the distance to the nearest vector feature for every cell. However, it can be a little finnicky about the values in the raster you give it, so it’s best to give it a blank raster. We can make one of these by creating a copy of the DEM and then setting all of the cells in that raster to <code>NA</code>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="raster-data-operations.html#cb38-1" aria-hidden="true" tabindex="-1"></a>naRaster<span class="ot">&lt;-</span>denverDEM</span>
<span id="cb38-2"><a href="raster-data-operations.html#cb38-2" aria-hidden="true" tabindex="-1"></a>naRaster[]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb38-3"><a href="raster-data-operations.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(naRaster)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>There you have it: a blank raster. Next, since this is a <code>terra</code> function, we’re going to turn our <code>sf</code> vector data into a SpatVector with <code>vect</code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="raster-data-operations.html#cb39-1" aria-hidden="true" tabindex="-1"></a>denverRail2<span class="ot">&lt;-</span><span class="fu">vect</span>(denverRail)</span>
<span id="cb39-2"><a href="raster-data-operations.html#cb39-2" aria-hidden="true" tabindex="-1"></a>denverRail2</span></code></pre></div>
<pre><code>##  class       : SpatVector 
##  geometry    : points 
##  dimensions  : 77, 29  (geometries, attributes)
##  extent      : -105.2013, -104.6739, 39.52047, 39.9229  (xmin, xmax, ymin, ymax)
##  coord. ref. : lon/lat WGS 84 (EPSG:4326) 
##  names       : OBJECTID   PID            NAME   LOCAL_RTS EXPRESS_RT LIMITED_RT
##  type        :    &lt;int&gt; &lt;int&gt;           &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;
##  values      :      157    64 Littleton / Mi~        402L         NA         NA
##                     158    63 Littleton / Do~ 29-36-59-66         NA         NA
##                     159    65 Oxford-City of~          51         NA         NA
##  REGIONAL_R SKYRIDE_RT SPECIAL_RT          ADDRESS (and 19 more)
##       &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;            &lt;chr&gt;              
##          NA         NA          D  3203 W Mineral~              
##          NA         NA          D 5777 S Prince St              
##          NA         NA          D  4101 Windermer~</code></pre>
<p>Now we’re ready to run the <code>distance</code> function. This might take a a few seconds to run.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="raster-data-operations.html#cb41-1" aria-hidden="true" tabindex="-1"></a>railDistance<span class="ot">&lt;-</span><span class="fu">distance</span>(naRaster,denverRail2)</span></code></pre></div>
<p>OK, so as you can see, we gave it an empty raster and a SpatVector object that both occupy the same space. This tells the <code>distance</code> function that we want to calculate the distance between them and turn that into our new object <code>railDistance</code>. Let’s take a look:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="raster-data-operations.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(railDistance)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>It looks a little crazy, but hopefully you can see that the white-ish points in this image are where the rail stations are, and then the color in the plot increases with distance from these locations. The distance is in meters by default.</p>
</div>
<div id="exploring-relationships-between-distance-and-another-feature" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Exploring relationships between distance and another feature<a href="raster-data-operations.html#exploring-relationships-between-distance-and-another-feature" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s figure our where our grocery stores fall in terms of distance from a rail station. First we add our grocery stores:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="raster-data-operations.html#cb43-1" aria-hidden="true" tabindex="-1"></a>denverGrocery<span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="st">&quot;denverGrocery.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `denverGrocery&#39; from data source 
##   `C:\Users\bdav_\Dropbox\Teaching\Spatial R Short Course\Bookdown\Exercise4\denverGrocery.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 446 features and 11 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 3109915 ymin: 1650081 xmax: 3219009 ymax: 1730349
## Projected CRS: NAD83(2011) / Colorado Central (ftUS)</code></pre>
<p>Careful here: this dataset is in the Colorado State Plane CRS, so it won’t work immediately with our WGS84 lat/long data. We can reproject it pretty easily, though:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="raster-data-operations.html#cb45-1" aria-hidden="true" tabindex="-1"></a>denverGroceryWGS<span class="ot">&lt;-</span><span class="fu">st_transform</span>(denverGrocery,<span class="dv">4326</span>)</span>
<span id="cb45-2"><a href="raster-data-operations.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(denverGroceryWGS)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 11 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -105.0257 ymin: 39.71079 xmax: -104.9731 ymax: 39.76008
## Geodetic CRS:  WGS 84
##   OBJECTID   POINT_X  POINT_Y        STORE_NAME          ADDRESS_LI
## 1        1 -105.0257 39.76009         WALGREENS 2975 N FEDERAL BLVD
## 2        2 -104.9838 39.74743      UPTOWN OASIS      298 E 20TH AVE
## 3        3 -104.9731 39.71089  DIAMOND SHAMROCK    300 S DOWNING ST
## 4        4 -104.9831 39.72552  LITTLE STAR MART       300 E 6TH AVE
## 5        5 -105.0246 39.71080 WALGREEN&#39;S #10935  300 S FEDERAL BLVD
## 6        6 -104.9888 39.74281    RUSSELL&#39;S #204         303 16TH ST
##          STORE_TYPE LICENSE_NU   CITY   ZIP SNAP WIC                   geometry
## 1 Convenience Store      75399 DENVER 80211   No  No POINT (-105.0257 39.76008)
## 2 Small Food Market    1052788 DENVER 80205   No  No POINT (-104.9838 39.74742)
## 3 Convenience Store      29906 DENVER 80209  Yes Yes POINT (-104.9731 39.71088)
## 4 Convenience Store          0 DENVER 80203   No  No POINT (-104.9831 39.72551)
## 5 Convenience Store    1040325 DENVER 80219  Yes Yes POINT (-105.0246 39.71079)
## 6 Convenience Store      14879 DENVER 80202   No  No  POINT (-104.9888 39.7428)</code></pre>
<p>Next we’ll subset it to true grocery stores:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="raster-data-operations.html#cb47-1" aria-hidden="true" tabindex="-1"></a>denverGrocs<span class="ot">&lt;-</span><span class="fu">subset</span>(denverGroceryWGS,STORE_TYPE<span class="sc">==</span><span class="st">&quot;Grocery Store&quot;</span>)</span>
<span id="cb47-2"><a href="raster-data-operations.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(denverGrocs)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 11 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -105.0514 ymin: 39.65479 xmax: -104.9444 ymax: 39.77618
## Geodetic CRS:  WGS 84
##    OBJECTID   POINT_X  POINT_Y             STORE_NAME           ADDRESS_LI
## 14       14 -105.0514 39.65480           KING SOOPERS 3100 S SHERIDAN BLVD
## 23       23 -104.9889 39.71038                SAFEWAY       323 S BROADWAY
## 40       40 -104.9444 39.74033 SPROUTS FARMERS MARKET    3625 E COLFAX AVE
## 44       44 -104.9874 39.70976        NATURAL GROCERS       368 S BROADWAY
## 45       45 -104.9759 39.77299        NATURAL GROCERS 3757 N BRIGHTON BLVD
## 49       49 -105.0366 39.77619                SAFEWAY      3800 W 44TH AVE
##       STORE_TYPE LICENSE_NU   CITY   ZIP SNAP WIC                   geometry
## 14 Grocery Store          0 DENVER 80219   No  No POINT (-105.0514 39.65479)
## 23 Grocery Store          0 DENVER 80209  Yes Yes POINT (-104.9889 39.71037)
## 40 Grocery Store    1045687 DENVER 80206  Yes Yes POINT (-104.9444 39.74032)
## 44 Grocery Store          0 DENVER 80209  Yes Yes POINT (-104.9873 39.70975)
## 45 Grocery Store          0 DENVER 80216   No  No POINT (-104.9759 39.77298)
## 49 Grocery Store          0 DENVER 80211  Yes Yes POINT (-105.0366 39.77618)</code></pre>
</div>
<div id="visualizing-and-quantifying-distance-relationships" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Visualizing and quantifying distance relationships<a href="raster-data-operations.html#visualizing-and-quantifying-distance-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>OK, let’s see what that looks like on the distance map:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="raster-data-operations.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(railDistance,<span class="at">axes=</span>T)</span>
<span id="cb49-2"><a href="raster-data-operations.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(denverGrocs),<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>What do you notice? There is definitely some overlap between where the rail stations are and where the grocery stores are, but there are also some places where it looks like a 5 km walk or more from the train!</p>
<p>What we really need now is to extract these raster values and see what the distribution looks like. To do that, we’re going to use the <code>extract</code> function. And again, since this is a <code>terra</code> function, we’ll convert our vector data to a SpatVector so it plays nicely.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="raster-data-operations.html#cb50-1" aria-hidden="true" tabindex="-1"></a>grocRailDist<span class="ot">&lt;-</span><span class="fu">extract</span>(railDistance,<span class="fu">vect</span>(denverGrocs))</span></code></pre></div>
<p>Doing this gives us table of values, and we can use the <code>$</code> operator to pass the column with the distance values to a histogram:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="raster-data-operations.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(grocRailDist<span class="sc">$</span>denverDEM)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>This is interesting: many grocery stores are pretty close to a rail station, but there are also a fair number that are 4, 5, or 6 kms away. While a resident of Denver might know this by gut instinct, we’ve now quantified this relationship. It’s official: we’re answering spatial questions!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vector-data-operations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bringing-it-all-together.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-RasterDataOperations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
