<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 3 Evaluating patterns | Spatial R Exercise 7</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 3 Evaluating patterns | Spatial R Exercise 7" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 3 Evaluating patterns | Spatial R Exercise 7" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Ben Davies" />


<meta name="date" content="2022-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-point-data-in-spatstat.html"/>
<link rel="next" href="quadrat-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting started with point patterns</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#loading-packages"><i class="fa fa-check"></i><b>1.1</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-point-data-in-spatstat.html"><a href="working-with-point-data-in-spatstat.html"><i class="fa fa-check"></i><b>2</b> Working with point data in <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-point-data-in-spatstat.html"><a href="working-with-point-data-in-spatstat.html#what-is-a-owin-object-what-is-a-ppp-object"><i class="fa fa-check"></i><b>2.1</b> What is a <code>owin</code> object? What is a <code>ppp</code> object?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="evaluating-patterns.html"><a href="evaluating-patterns.html"><i class="fa fa-check"></i><b>3</b> Evaluating patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="evaluating-patterns.html"><a href="evaluating-patterns.html#nearest-neighbor"><i class="fa fa-check"></i><b>3.1</b> Nearest neighbor</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrat analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html#kernel-density-estimation"><i class="fa fa-check"></i><b>4.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="4.2" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html#try-it-yourself"><i class="fa fa-check"></i><b>4.2</b> Try it yourself</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bringing-it-all-together.html"><a href="bringing-it-all-together.html"><i class="fa fa-check"></i><b>5</b> Bringing it all together!</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial R Exercise 7</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="evaluating-patterns" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Part  3</span> Evaluating patterns<a href="evaluating-patterns.html#evaluating-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Now that we’ve got an understanding of <code>spatstat</code> objects, let’s put them to use. Methods of spatial analysis developed for points usually concern two main aspects of their spatial patterning: density and distance.</p>
<div id="nearest-neighbor" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Nearest neighbor<a href="evaluating-patterns.html#nearest-neighbor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spatial patterning in point data is often characterized by how our observed data are clustered or dispersed. Clustering might indicate some underlying process of attraction (e.g., resource abundance), while dispersed points may indicate A useful metric here is nearest neighbor distance: how far is each point from</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="evaluating-patterns.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">nndist</span>(primatesPoints))</span></code></pre></div>
<pre><code>## [1]   101.73072 16672.19195    60.50261    60.50261     0.00000     0.00000</code></pre>
<p>The Clark-Evans test helps us to summarize these relationships over the entire dataset. Basically, this approach:</p>
<ul>
<li>Determines the average of distances between individual points in the observed data and their nearest neighbouring points.
<em>Simulates distributions for the same number of points randomly distributed in the same space and calculates the same average nearest neighbour distance.
</em>Divides the average nearest neighbour distance for the observed data by the mean of the simulated distributions.</li>
</ul>
<p>For this metric, values over 1 tend to indicate patterns that are uniformly distributed, while values We can see what this looks like with our randomly distributed points:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="evaluating-patterns.html#cb47-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb47-2"><a href="evaluating-patterns.html#cb47-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb47-3"><a href="evaluating-patterns.html#cb47-3" aria-hidden="true" tabindex="-1"></a>xy<span class="ot">&lt;-</span><span class="fu">data.frame</span>(x,y)</span>
<span id="cb47-4"><a href="evaluating-patterns.html#cb47-4" aria-hidden="true" tabindex="-1"></a>w<span class="ot">&lt;-</span><span class="fu">owin</span>(<span class="fu">c</span>(<span class="fu">min</span>(x),<span class="fu">max</span>(x)),<span class="fu">c</span>(<span class="fu">min</span>(y),<span class="fu">max</span>(y)))</span>
<span id="cb47-5"><a href="evaluating-patterns.html#cb47-5" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">as.ppp</span>(xy,w)</span>
<span id="cb47-6"><a href="evaluating-patterns.html#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="evaluating-patterns.html#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">nndist</span>(data))</span></code></pre></div>
<pre><code>## [1] 0.05761763</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="evaluating-patterns.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans</span>(data)</span></code></pre></div>
<pre><code>##    naive Donnelly      cdf 
## 1.172815 1.122938 1.114419</code></pre>
<p>Here, we can see that the data are pretty close to one. This is what we’d expect from randomly distributed data. Now let’s take a look at our primate data.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="evaluating-patterns.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">nndist</span>(primatesPoints))</span></code></pre></div>
<pre><code>## [1] 1171.82</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="evaluating-patterns.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans</span>(primatesPoints)</span></code></pre></div>
<pre><code>##     naive       cdf 
## 0.2415733 0.1920958</code></pre>
<p>Our primate groups are, on average around a kilometer from their nearest neighbor. And, confirming what we could see from the, there is some notable clustering.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-point-data-in-spatstat.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="quadrat-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-visualizing-patterns.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
