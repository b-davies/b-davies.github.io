<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Part 4 Quadrat analysis | Spatial R Exercise 7</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Part 4 Quadrat analysis | Spatial R Exercise 7" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Part 4 Quadrat analysis | Spatial R Exercise 7" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Ben Davies" />


<meta name="date" content="2022-05-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evaluating-patterns.html"/>
<link rel="next" href="bringing-it-all-together.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting started with point patterns</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#loading-packages"><i class="fa fa-check"></i><b>1.1</b> Loading packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-point-data-in-spatstat.html"><a href="working-with-point-data-in-spatstat.html"><i class="fa fa-check"></i><b>2</b> Working with point data in <code>spatstat</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-point-data-in-spatstat.html"><a href="working-with-point-data-in-spatstat.html#what-is-a-owin-object-what-is-a-ppp-object"><i class="fa fa-check"></i><b>2.1</b> What is a <code>owin</code> object? What is a <code>ppp</code> object?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="evaluating-patterns.html"><a href="evaluating-patterns.html"><i class="fa fa-check"></i><b>3</b> Evaluating patterns</a>
<ul>
<li class="chapter" data-level="3.1" data-path="evaluating-patterns.html"><a href="evaluating-patterns.html#nearest-neighbor"><i class="fa fa-check"></i><b>3.1</b> Nearest neighbor</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html"><i class="fa fa-check"></i><b>4</b> Quadrat analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html#kernel-density-estimation"><i class="fa fa-check"></i><b>4.1</b> Kernel Density Estimation</a></li>
<li class="chapter" data-level="4.2" data-path="quadrat-analysis.html"><a href="quadrat-analysis.html#try-it-yourself"><i class="fa fa-check"></i><b>4.2</b> Try it yourself</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bringing-it-all-together.html"><a href="bringing-it-all-together.html"><i class="fa fa-check"></i><b>5</b> Bringing it all together!</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial R Exercise 7</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="quadrat-analysis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Part  4</span> Quadrat analysis<a href="quadrat-analysis.html#quadrat-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For quadrat analysis, we divide the up the study area into a regular grid and then count how many instances there are of a thing in that grid. In the case of Ecuador, we’ll divide it into a 8x8 grid.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="quadrat-analysis.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">quadrats</span>(ecWin,<span class="dv">8</span>,<span class="dv">8</span>),<span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>We can also create a primate dataset without marks. This is mostly just so they won’t plot.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="quadrat-analysis.html#cb56-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">unmark</span>(primatesPoints)</span></code></pre></div>
<p>Now we can use <code>quadratcounts</code></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="quadrat-analysis.html#cb57-1" aria-hidden="true" tabindex="-1"></a>quad <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(p, <span class="at">nx=</span> <span class="dv">8</span>, <span class="at">ny=</span><span class="dv">8</span>)</span>
<span id="cb57-2"><a href="quadrat-analysis.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot points</span></span>
<span id="cb57-3"><a href="quadrat-analysis.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cols=</span><span class="st">&quot;grey&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>) </span>
<span id="cb57-4"><a href="quadrat-analysis.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(quad, <span class="at">add=</span><span class="cn">TRUE</span>)  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>Just looking at this pattern, we can see that some quadrats have more than 100 observations, while others have none at all. This suggests intuitively that the distribution of is patterned, but we can estimate whether this is meaningful using <code>quadrat.test</code>.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="quadrat-analysis.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quadrat.test</span>(p, <span class="dv">8</span>, <span class="dv">8</span>)</span></code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</code></pre>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  p
## X2 = 11974, df = 49, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided
## 
## Quadrats: 50 tiles (irregular windows)</code></pre>
<p>Note that the p-value is &lt; 2.2e-16. This means that the</p>
<div id="kernel-density-estimation" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Kernel Density Estimation<a href="quadrat-analysis.html#kernel-density-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can visualize broad scale patterning in our data through a kernel density estimate (KDE). This is similar to the above approaches in that it calculates the number of of instances</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="quadrat-analysis.html#cb61-1" aria-hidden="true" tabindex="-1"></a>ecDensity <span class="ot">&lt;-</span> <span class="fu">density</span>(p)</span>
<span id="cb61-2"><a href="quadrat-analysis.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ecDensity,<span class="at">main=</span><span class="st">&quot;Primate Observation Density&quot;</span>)</span>
<span id="cb61-3"><a href="quadrat-analysis.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p,<span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>These exercises are meant to introduce you to <code>spatstat</code> and start looking at spatial analysis in R.</p>
</div>
<div id="try-it-yourself" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Try it yourself<a href="quadrat-analysis.html#try-it-yourself" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>spatstat</code> comes with some pre-made datasets to test things out with. These are already saved as <code>ppp</code> objects when you call them. Try doing the following:</p>
<ul>
<li>Look at nearest neighbor with the <code>redwoods</code> and <code>amacrine</code> datasets</li>
<li>Create a kernel density estimate from the <code>cells</code> data</li>
<li>Do a quadrat analysis, including the quadrat test, using the <code>nztrees</code> data</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluating-patterns.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bringing-it-all-together.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-visualizing-patterns.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
